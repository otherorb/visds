[32m2022-11-04 12:45:46 -0700[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - eadb2f19-8273-49dd-b940-3fd87416a062 - 1779437 - vis_raw_fetch_todb - LOGS_CAPTURED - Started capturing logs for step: vis_raw_fetch_todb.
[32m2022-11-04 12:45:46 -0700[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - eadb2f19-8273-49dd-b940-3fd87416a062 - 1779437 - vis_raw_fetch_todb - STEP_START - Started execution of step "vis_raw_fetch_todb".
Problem while processing message. Closing connection
Traceback (most recent call last):
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1901, in _execute_context
    cursor, statement, parameters, context
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedTable: relation "raw_products" does not exist
LINE 1: INSERT INTO raw_products (adc_gain, auto_exposure, bad_pixel...
                    ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/yamcs/core/subscriptions.py", line 148, in _on_websocket_message
    self._callback(data)
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/yamcs/tmtc/client.py", line 62, in _wrap_callback_parse_parameter_data
    on_data(parameter_data)
  File "/Work/VIPER/vipersci/src/vipersci/vis/pds/create_raw.py", line 202, in from_yamcs_parameters
    self.__call__(d, im)
  File "/Work/VIPER/vipersci/src/vipersci/vis/pds/create_raw.py", line 172, in __call__
    s.add(rp)
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/contextlib.py", line 119, in __exit__
    next(self.gen)
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 1173, in _maker_context_manager
    yield self
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/engine/util.py", line 237, in __exit__
    self.rollback()
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/engine/util.py", line 233, in __exit__
    self.commit()
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 829, in commit
    self._prepare_impl()
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 808, in _prepare_impl
    self.session.flush()
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 3429, in flush
    self._flush(objects)
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 3569, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 72, in __exit__
    with_traceback=exc_tb,
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 3529, in _flush
    flush_context.execute()
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/orm/unitofwork.py", line 456, in execute
    rec.execute(self)
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/orm/unitofwork.py", line 633, in execute
    uow,
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/orm/persistence.py", line 250, in save_obj
    insert,
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/orm/persistence.py", line 1241, in _emit_insert_statements
    execution_options=execution_options,
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    self, multiparams, params, execution_options
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1582, in _execute_clauseelement
    cache_hit=cache_hit,
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1944, in _execute_context
    e, statement, parameters, cursor, context
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2125, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1901, in _execute_context
    cursor, statement, parameters, context
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedTable) relation "raw_products" does not exist
LINE 1: INSERT INTO raw_products (adc_gain, auto_exposure, bad_pixel...
                    ^

[SQL: INSERT INTO raw_products (adc_gain, auto_exposure, bad_pixel_table_id, capture_id, exposure_duration, file_creation_datetime, file_path, hazlight_aft_port_on, hazlight_aft_starboard_on, hazlight_center_port_on, hazlight_center_starboard_on, hazlight_fore_port_on, hazlight_fore_starboard_on, image_id, instrument_name, instrument_temperature, lines, lobt, mcam_id, md5_checksum, mission_phase, navlight_left_on, navlight_right_on, "offset", onboard_compression_ratio, onboard_compression_type, output_image_mask, output_image_type, product_id, padding, pga_gain, processing_info, purpose, samples, software_name, software_version, software_type, software_program_name, start_time, stereo, stop_time, voltage_ramp, yamcs_generation_time, yamcs_name) VALUES (%(adc_gain)s, %(auto_exposure)s, %(bad_pixel_table_id)s, %(capture_id)s, %(exposure_duration)s, %(file_creation_datetime)s, %(file_path)s, %(hazlight_aft_port_on)s, %(hazlight_aft_starboard_on)s, %(hazlight_center_port_on)s, %(hazlight_center_starboard_on)s, %(hazlight_fore_port_on)s, %(hazlight_fore_starboard_on)s, %(image_id)s, %(instrument_name)s, %(instrument_temperature)s, %(lines)s, %(lobt)s, %(mcam_id)s, %(md5_checksum)s, %(mission_phase)s, %(navlight_left_on)s, %(navlight_right_on)s, %(offset)s, %(onboard_compression_ratio)s, %(onboard_compression_type)s, %(output_image_mask)s, %(output_image_type)s, %(product_id)s, %(padding)s, %(pga_gain)s, %(processing_info)s, %(purpose)s, %(samples)s, %(software_name)s, %(software_version)s, %(software_type)s, %(software_program_name)s, %(start_time)s, %(stereo)s, %(stop_time)s, %(voltage_ramp)s, %(yamcs_generation_time)s, %(yamcs_name)s) RETURNING raw_products.id]
[parameters: {'adc_gain': 0, 'auto_exposure': False, 'bad_pixel_table_id': 0, 'capture_id': 21, 'exposure_duration': 111, 'file_creation_datetime': datetime.datetime(2022, 11, 4, 19, 45, 47, 385901, tzinfo=datetime.timezone.utc), 'file_path': '231125-143859-ncl-d.tif', 'hazlight_aft_port_on': False, 'hazlight_aft_starboard_on': False, 'hazlight_center_port_on': False, 'hazlight_center_starboard_on': False, 'hazlight_fore_port_on': False, 'hazlight_fore_starboard_on': False, 'image_id': 36, 'instrument_name': 'NavCam Left', 'instrument_temperature': 0, 'lines': 2048, 'lobt': 1700923139, 'mcam_id': 0, 'md5_checksum': '8c708f5745ad2b6d9bac6036062bbd31', 'mission_phase': 'TEST', 'navlight_left_on': False, 'navlight_right_on': False, 'offset': 0, 'onboard_compression_ratio': 64, 'onboard_compression_type': 'ICER', 'output_image_mask': 8, 'output_image_type': 'LOSSY_ICER_IMAGE', 'product_id': '231125-143859-ncl-d', 'padding': 0, 'pga_gain': 1, 'processing_info': 20, 'purpose': 'Navigation', 'samples': 2048, 'software_name': 'vipersci', 'software_version': '0.1.0', 'software_type': 'Python', 'software_program_name': 'vipersci.vis.pds.create_raw', 'start_time': datetime.datetime(2023, 11, 25, 14, 38, 59, tzinfo=datetime.timezone.utc), 'stereo': True, 'stop_time': datetime.datetime(2023, 11, 25, 14, 38, 59, 111, tzinfo=datetime.timezone.utc), 'voltage_ramp': 0, 'yamcs_generation_time': datetime.datetime(2022, 11, 4, 18, 22, 50, 679000, tzinfo=datetime.timezone.utc), 'yamcs_name': '/ViperGround/Images/ImageData/Navcam_left_icer'}]
(Background on this error at: https://sqlalche.me/e/14/f405)
[32m2022-11-04 14:33:45 -0700[0m - dagster - [34mERROR[0m - [31m__ASSET_JOB - eadb2f19-8273-49dd-b940-3fd87416a062 - 1779437 - vis_raw_fetch_todb - STEP_FAILURE - Execution of step "vis_raw_fetch_todb" failed.

dagster._core.errors.DagsterExecutionInterruptedError

Stack Trace:
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/dagster/_core/execution/plan/execute_plan.py", line 225, in dagster_event_sequence_for_step
    for step_event in check.generator(step_events):
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/dagster/_core/execution/plan/execute_step.py", line 361, in core_dagster_event_sequence_for_step
    _step_output_error_checked_user_event_sequence(step_context, user_event_sequence)
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/dagster/_core/execution/plan/execute_step.py", line 69, in _step_output_error_checked_user_event_sequence
    for user_event in user_event_sequence:
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/dagster/_core/execution/plan/compute.py", line 174, in execute_core_compute
    for step_output in _yield_compute_results(step_context, inputs, compute_fn):
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/dagster/_core/execution/plan/compute.py", line 151, in _yield_compute_results
    user_event_generator,
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/dagster/_utils/__init__.py", line 430, in iterate_with_context
    next_output = next(iterator)
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/dagster/_core/execution/plan/compute_generator.py", line 74, in _coerce_solid_compute_fn_to_iterator
    result = fn(context, **kwargs) if context_arg_provided else fn(**kwargs)
  File "/Work/VIPER/dagster/visdag/visdag/assets/vis_raw_fetch.py", line 49, in vis_raw_fetch_todb
  File "/Work/VIPER/dagster/visdag/visdag/watcher.py", line 126, in do_db
    wait_loop()
  File "/Work/VIPER/dagster/visdag/visdag/watcher.py", line 205, in wait_loop
    sleep(5)
  File "/Work/Anaconda/anaconda3_2022_Oct/envs/dagster/lib/python3.7/site-packages/dagster/_utils/interrupts.py", line 74, in _new_signal_handler
    raise error_cls()
[0m
